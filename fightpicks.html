<!DOCTYPE html>

<head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css">
    <style>
        .dt-container .row,
        #title-history_wrapper .row {
            margin: 0 !important;
        }

        .dt-container .row div,
        #title-history_wrapper .row div {
            padding: 0 !important;
        }
    </style>
</head>

<body data-bs-theme="dark">
    <div class="container">

        <h1 class="text-center mt-3">FightPicks League</h1>

        <div class="card mt-3">
            <div class="card-header">
                <h3 class="text-center mb-0">League Table</h3>
            </div>
            <div class="card-body p-0 text-nowrap">
                <div class="table-responsive">
                    <table id="league-table" class="table table-sm table-striped m-0"></table>
                </div>
            </div>
        </div>

        <div class="card mt-3">
            <div class="card-header">
                <h3 class="text-center mb-0">Title History</h3>
            </div>
            <div class="card-body p-0 text-nowrap">
                <div class="table-responsive">
                    <table id="title-history" class="table table-sm table-striped m-0"></table>
                </div>
            </div>
        </div>

        <div class="card mt-3 mb-3">
            <div class="card-header">
                <h3 class="text-center">Event Results</h3>
                <select id="event-result-select" class="form-control"></select>
            </div>
            <div class="card-body p-0 text-nowrap">
                <div class="table-responsive">
                    <table id="event-results" class="table table-sm table-striped m-0">
                        <thead>
                            <tr>
                                <th colspan="5"></th>
                                <th colspan="6" class="text-center">Alex</th>
                                <th colspan="6" class="text-center">Kieran</th>
                                <th colspan="6" class="text-center">Rob</th>
                                <th colspan="6" class="text-center">Jake</th>
                            </tr>
                            <tr>
                                <th>#</th>
                                <th>Fight</th>
                                <th>Winner</th>
                                <th>M.</th>
                                <th>R.</th>
                                <th>Pick</th>
                                <th>M.</th>
                                <th>R.</th>
                                <th>Pts.</th>
                                <th>£+/-</th>
                                <th>Total</th>
                                <th>Pick</th>
                                <th>M.</th>
                                <th>R.</th>
                                <th>Pts.</th>
                                <th>£+/-</th>
                                <th>Total</th>
                                <th>Pick</th>
                                <th>M.</th>
                                <th>R.</th>
                                <th>Pts.</th>
                                <th>£+/-</th>
                                <th>Total</th>
                                <th>Pick</th>
                                <th>M.</th>
                                <th>R.</th>
                                <th>Pts.</th>
                                <th>£+/-</th>
                                <th>Total</th>
                            </tr>

                        </thead>
                        <tbody>

                        </tbody>
                    </table>
                </div>
            </div>
            <div class="card-body p-0">
                <canvas id="event-result-canvas" style="min-height:640px;"></canvas>
            </div>
        </div>

    </div>

    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.min.js"></script>
    <script src="https://cdn.datatables.net/2.2.1/js/dataTables.js"></script>
    <script src="https://cdn.datatables.net/2.2.1/js/dataTables.bootstrap5.js"></script>
    <script src="https://cdn.datatables.net/plug-ins/2.2.1/sorting/currency.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script>
        const players = ["Alex", "Kieran", "Rob", "Jake"];
        const CHART_COLORS = {
                red: 'rgb(255, 99, 132)',
                yellow: 'rgb(255, 205, 86)',
                green: 'rgb(75, 192, 192)',
                blue: 'rgb(54, 162, 235)'
            };
        const fightData = [
            { Card: 'UFC 300: Pereira vs Hill', Date: '2024-04-13', Left: 'Deiveson Figueiredo', Right: 'Cody Garbrandt', LeftLine: 1.33, RightLine: 3.4, FiveRound: false, Winner: 'Deiveson Figueiredo', Method: 'Submission', Round: '2', Picks: { Alex: { Pick: 'Deiveson Figueiredo', Method: 'Knockout', Round: '1', Points: 5, CardTotal: 5, Total: 5, Profit: 0.33 }, Kieran: { Pick: 'Deiveson Figueiredo', Method: 'Knockout', Round: '1', Points: 5, CardTotal: 5, Total: 5, Profit: 0.33 }, Rob: { Pick: 'Cody Garbrandt', Method: 'Decision', Round: 'D', Points: 0, CardTotal: 0, Total: 0, Profit: -1 }, Jake: { Pick: 'Deiveson Figueiredo', Method: 'Submission', Round: '2', Points: 15, CardTotal: 15, Total: 15, Profit: 0.33 }, } },
            { Card: 'UFC 300: Pereira vs Hill', Date: '2024-04-13', Left: 'Bobby Green', Right: 'Jim Miller', LeftLine: 1.57, RightLine: 2.5, FiveRound: false, Winner: 'Bobby Green', Method: 'Decision', Round: 'D', Picks: { Alex: { Pick: 'Bobby Green', Method: 'Decision', Round: 'D', Points: 15, CardTotal: 20, Total: 20, Profit: 0.57 }, Kieran: { Pick: 'Bobby Green', Method: 'Decision', Round: 'D', Points: 15, CardTotal: 20, Total: 20, Profit: 0.57 }, Rob: { Pick: 'Bobby Green', Method: 'Decision', Round: 'D', Points: 15, CardTotal: 15, Total: 15, Profit: 0.57 }, Jake: { Pick: 'Jim Miller', Method: 'Submission', Round: '2', Points: 0, CardTotal: 15, Total: 15, Profit: -1 }, } },
            { Card: 'UFC 300: Pereira vs Hill', Date: '2024-04-13', Left: 'Jessica Andrade', Right: 'Marina Rodriguez', LeftLine: 1.8, RightLine: 2, FiveRound: false, Winner: 'Jessica Andrade', Method: 'Decision', Round: 'D', Picks: { Alex: { Pick: 'Jessica Andrade', Method: 'Decision', Round: 'D', Points: 15, CardTotal: 35, Total: 35, Profit: 0.8 }, Kieran: { Pick: 'Marina Rodriguez', Method: 'Decision', Round: 'D', Points: 0, CardTotal: 20, Total: 20, Profit: -1 }, Rob: { Pick: 'Jessica Andrade', Method: 'Decision', Round: 'D', Points: 15, CardTotal: 30, Total: 30, Profit: 0.8 }, Jake: { Pick: 'Jessica Andrade', Method: 'Decision', Round: 'D', Points: 15, CardTotal: 30, Total: 30, Profit: 0.8 }, } },
            { Card: 'UFC 300: Pereira vs Hill', Date: '2024-04-13', Left: 'Jalin Turner', Right: 'Renato Moicano', LeftLine: 1.4, RightLine: 3, FiveRound: false, Winner: 'Jalin Turner', Method: 'Decision', Round: 'D', Picks: { Alex: { Pick: 'Jalin Turner', Method: 'Knockout', Round: '3', Points: 5, CardTotal: 40, Total: 40, Profit: 0.4 }, Kieran: { Pick: 'Jalin Turner', Method: 'Knockout', Round: '1', Points: 5, CardTotal: 25, Total: 25, Profit: 0.4 }, Rob: { Pick: 'Jalin Turner', Method: 'Decision', Round: 'D', Points: 15, CardTotal: 45, Total: 45, Profit: 0.4 }, Jake: { Pick: 'Jalin Turner', Method: 'Decision', Round: 'D', Points: 15, CardTotal: 45, Total: 45, Profit: 0.4 }, } },
            { Card: 'UFC 300: Pereira vs Hill', Date: '2024-04-13', Left: 'Sodiq Yusuff', Right: 'Diego Lopes', LeftLine: 2.1, RightLine: 1.72, FiveRound: false, Winner: 'Diego Lopes', Method: 'Knockout', Round: '1', Picks: { Alex: { Pick: 'Sodiq Yusuff', Method: 'Decision', Round: 'D', Points: 0, CardTotal: 40, Total: 40, Profit: -1 }, Kieran: { Pick: 'Diego Lopes', Method: 'Knockout', Round: '1', Points: 15, CardTotal: 40, Total: 40, Profit: 0.72 }, Rob: { Pick: 'Diego Lopes', Method: 'Knockout', Round: '1', Points: 15, CardTotal: 60, Total: 60, Profit: 0.72 }, Jake: { Pick: 'Diego Lopes', Method: 'Decision', Round: 'D', Points: 5, CardTotal: 50, Total: 50, Profit: 0.72 }, } },
            { Card: 'UFC 300: Pereira vs Hill', Date: '2024-04-13', Left: 'Holly Holm', Right: 'Kayla Harrison', LeftLine: 4.5, RightLine: 1.22, FiveRound: false, Winner: 'Kayla Harrison', Method: 'Decision', Round: 'D', Picks: { Alex: { Pick: 'Kayla Harrison', Method: 'Decision', Round: 'D', Points: 15, CardTotal: 55, Total: 55, Profit: 0.22 }, Kieran: { Pick: 'Kayla Harrison', Method: 'Decision', Round: 'D', Points: 15, CardTotal: 55, Total: 55, Profit: 0.22 }, Rob: { Pick: 'Kayla Harrison', Method: 'Decision', Round: 'D', Points: 15, CardTotal: 75, Total: 75, Profit: 0.22 }, Jake: { Pick: 'Kayla Harrison', Method: 'Decision', Round: 'D', Points: 15, CardTotal: 65, Total: 65, Profit: 0.22 }, } },
            { Card: 'UFC 300: Pereira vs Hill', Date: '2024-04-13', Left: 'Calvin Kattar', Right: 'Aljamain Sterling', LeftLine: 2.4, RightLine: 1.58, FiveRound: false, Winner: 'Aljamain Sterling', Method: 'Decision', Round: 'D', Picks: { Alex: { Pick: 'Aljamain Sterling', Method: 'Submission', Round: '2', Points: 5, CardTotal: 60, Total: 60, Profit: 0.58 }, Kieran: { Pick: 'Aljamain Sterling', Method: 'Decision', Round: 'D', Points: 15, CardTotal: 70, Total: 70, Profit: 0.58 }, Rob: { Pick: 'Aljamain Sterling', Method: 'Knockout', Round: '2', Points: 5, CardTotal: 80, Total: 80, Profit: 0.58 }, Jake: { Pick: 'Aljamain Sterling', Method: 'Knockout', Round: '2', Points: 5, CardTotal: 70, Total: 70, Profit: 0.58 }, } },
            { Card: 'UFC 300: Pereira vs Hill', Date: '2024-04-13', Left: 'Jiri Prochazka', Right: 'Aleksandar Rakic', LeftLine: 2, RightLine: 1.8, FiveRound: false, Winner: 'Jiri Prochazka', Method: 'Knockout', Round: '2', Picks: { Alex: { Pick: 'Jiri Prochazka', Method: 'Knockout', Round: '1', Points: 7, CardTotal: 67, Total: 67, Profit: 1 }, Kieran: { Pick: 'Jiri Prochazka', Method: 'Knockout', Round: '1', Points: 7, CardTotal: 77, Total: 77, Profit: 1 }, Rob: { Pick: 'Jiri Prochazka', Method: 'Decision', Round: 'D', Points: 5, CardTotal: 85, Total: 85, Profit: 1 }, Jake: { Pick: 'Aleksandar Rakic', Method: 'Decision', Round: 'D', Points: 0, CardTotal: 70, Total: 70, Profit: -1 }, } },
            { Card: 'UFC 300: Pereira vs Hill', Date: '2024-04-13', Left: 'Bo Nickal', Right: 'Cody Brundage', LeftLine: 1.05, RightLine: 11, FiveRound: false, Winner: 'Bo Nickal', Method: 'Submission', Round: '2', Picks: { Alex: { Pick: 'Bo Nickal', Method: 'Submission', Round: '1', Points: 7, CardTotal: 74, Total: 74, Profit: 0.05 }, Kieran: { Pick: 'Bo Nickal', Method: 'Knockout', Round: '2', Points: 8, CardTotal: 85, Total: 85, Profit: 0.05 }, Rob: { Pick: 'Bo Nickal', Method: 'Knockout', Round: '2', Points: 8, CardTotal: 93, Total: 93, Profit: 0.05 }, Jake: { Pick: 'Bo Nickal', Method: 'Submission', Round: '1', Points: 7, CardTotal: 77, Total: 77, Profit: 0.05 }, } },
            { Card: 'UFC 300: Pereira vs Hill', Date: '2024-04-13', Left: 'Charles Oliveira', Right: 'Arman Tsarukyan', LeftLine: 2.87, RightLine: 1.44, FiveRound: false, Winner: 'Arman Tsarukyan', Method: 'Decision', Round: 'D', Picks: { Alex: { Pick: 'Arman Tsarukyan', Method: 'Decision', Round: 'D', Points: 15, CardTotal: 89, Total: 89, Profit: 0.44 }, Kieran: { Pick: 'Charles Oliveira', Method: 'Submission', Round: '2', Points: 0, CardTotal: 85, Total: 85, Profit: -1 }, Rob: { Pick: 'Charles Oliveira', Method: 'Submission', Round: '2', Points: 0, CardTotal: 93, Total: 93, Profit: -1 }, Jake: { Pick: 'Charles Oliveira', Method: 'Knockout', Round: '2', Points: 0, CardTotal: 77, Total: 77, Profit: -1 }, } },
            { Card: 'UFC 300: Pereira vs Hill', Date: '2024-04-13', Left: 'Justin Gaethje', Right: 'Max Holloway', LeftLine: 1.57, RightLine: 2.5, FiveRound: true, Winner: 'Max Holloway', Method: 'Knockout', Round: '5', Picks: { Alex: { Pick: 'Justin Gaethje', Method: 'Decision', Round: 'D', Points: 0, CardTotal: 89, Total: 89, Profit: -1 }, Kieran: { Pick: 'Justin Gaethje', Method: 'Knockout', Round: '2', Points: 0, CardTotal: 85, Total: 85, Profit: -1 }, Rob: { Pick: 'Justin Gaethje', Method: 'Decision', Round: 'D', Points: 0, CardTotal: 93, Total: 93, Profit: -1 }, Jake: { Pick: 'Justin Gaethje', Method: 'Decision', Round: 'D', Points: 0, CardTotal: 77, Total: 77, Profit: -1 }, } },
            { Card: 'UFC 300: Pereira vs Hill', Date: '2024-04-13', Left: 'Zhang Weili', Right: 'Yan Xiaonan', LeftLine: 1.25, RightLine: 4, FiveRound: true, Winner: 'Zhang Weili', Method: 'Decision', Round: 'D', Picks: { Alex: { Pick: 'Zhang Weili', Method: 'Decision', Round: 'D', Points: 30, CardTotal: 119, Total: 119, Profit: 0.25 }, Kieran: { Pick: 'Zhang Weili', Method: 'Knockout', Round: '2', Points: 10, CardTotal: 95, Total: 95, Profit: 0.25 }, Rob: { Pick: 'Zhang Weili', Method: 'Decision', Round: 'D', Points: 30, CardTotal: 123, Total: 123, Profit: 0.25 }, Jake: { Pick: 'Zhang Weili', Method: 'Decision', Round: 'D', Points: 30, CardTotal: 107, Total: 107, Profit: 0.25 }, } },
            { Card: 'UFC 300: Pereira vs Hill', Date: '2024-04-13', Left: 'Alex Pereira', Right: 'Jamahal Hill', LeftLine: 1.8, RightLine: 2, FiveRound: true, Winner: 'Alex Pereira', Method: 'Knockout', Round: '1', Picks: { Alex: { Pick: 'Alex Pereira', Method: 'Knockout', Round: '2', Points: 14, CardTotal: 133, Total: 133, Profit: 0.8 }, Kieran: { Pick: 'Jamahal Hill', Method: 'Decision', Round: 'D', Points: 0, CardTotal: 95, Total: 95, Profit: -1 }, Rob: { Pick: 'Alex Pereira', Method: 'Knockout', Round: '3', Points: 14, CardTotal: 137, Total: 137, Profit: 0.8 }, Jake: { Pick: 'Alex Pereira', Method: 'Knockout', Round: '2', Points: 14, CardTotal: 121, Total: 121, Profit: 0.8 }, } },
            { Card: 'UFC 304: Edwards vs Muhammad', Date: '2024-07-27', Left: 'Shauna Bannon', Right: 'Alice Ardelean', LeftLine: 2.1, RightLine: 1.72, FiveRound: false, Winner: 'Shauna Bannon', Method: 'Decision', Round: 'D', Picks: { Alex: { Pick: 'Shauna Bannon', Method: 'Decision', Round: 'D', Points: 15, CardTotal: 15, Total: 148, Profit: 1.1 }, Kieran: { Pick: 'Shauna Bannon', Method: 'Decision', Round: 'D', Points: 15, CardTotal: 15, Total: 110, Profit: 1.1 }, Rob: { Pick: 'Alice Ardelean', Method: 'Decision', Round: 'D', Points: 0, CardTotal: 0, Total: 137, Profit: -1 }, Jake: { Pick: 'Shauna Bannon', Method: 'Decision', Round: 'D', Points: 15, CardTotal: 15, Total: 136, Profit: 1.1 }, } },
            { Card: 'UFC 304: Edwards vs Muhammad', Date: '2024-07-27', Left: 'Mick Parkin', Right: 'Lukasz Brzeski', LeftLine: 1.5, RightLine: 2.7, FiveRound: false, Winner: 'Mick Parkin', Method: 'Knockout', Round: '1', Picks: { Alex: { Pick: 'Mick Parkin', Method: 'Decision', Round: 'D', Points: 5, CardTotal: 20, Total: 153, Profit: 0.5 }, Kieran: { Pick: 'Mick Parkin', Method: 'Decision', Round: 'D', Points: 5, CardTotal: 20, Total: 115, Profit: 0.5 }, Rob: { Pick: 'Mick Parkin', Method: 'Decision', Round: 'D', Points: 5, CardTotal: 5, Total: 142, Profit: 0.5 }, Jake: { Pick: 'Mick Parkin', Method: 'Decision', Round: 'D', Points: 5, CardTotal: 20, Total: 141, Profit: 0.5 }, } },
            { Card: 'UFC 304: Edwards vs Muhammad', Date: '2024-07-27', Left: 'Sam Patterson', Right: 'Kiefer Crosbie', LeftLine: 1.33, RightLine: 3.4, FiveRound: false, Winner: 'Sam Patterson', Method: 'Submission', Round: '1', Picks: { Alex: { Pick: 'Sam Patterson', Method: 'Submission', Round: '2', Points: 7, CardTotal: 27, Total: 160, Profit: 0.33 }, Kieran: { Pick: 'Sam Patterson', Method: 'Submission', Round: '2', Points: 7, CardTotal: 27, Total: 122, Profit: 0.33 }, Rob: { Pick: 'Sam Patterson', Method: 'Submission', Round: '2', Points: 7, CardTotal: 12, Total: 149, Profit: 0.33 }, Jake: { Pick: 'Sam Patterson', Method: 'Submission', Round: '2', Points: 7, CardTotal: 27, Total: 148, Profit: 0.33 }, } },
            { Card: 'UFC 304: Edwards vs Muhammad', Date: '2024-07-27', Left: 'Modestas Bukauskas', Right: 'Marcin Prachnio', LeftLine: 1.66, RightLine: 2.25, FiveRound: false, Winner: 'Modestas Bukauskas', Method: 'Submission', Round: '3', Picks: { Alex: { Pick: 'Modestas Bukauskas', Method: 'Decision', Round: 'D', Points: 5, CardTotal: 32, Total: 165, Profit: 0.66 }, Kieran: { Pick: 'Modestas Bukauskas', Method: 'Decision', Round: 'D', Points: 5, CardTotal: 32, Total: 127, Profit: 0.66 }, Rob: { Pick: 'Modestas Bukauskas', Method: 'Decision', Round: 'D', Points: 5, CardTotal: 17, Total: 154, Profit: 0.66 }, Jake: { Pick: 'Modestas Bukauskas', Method: 'Decision', Round: 'D', Points: 5, CardTotal: 32, Total: 153, Profit: 0.66 }, } },
            { Card: 'UFC 304: Edwards vs Muhammad', Date: '2024-07-27', Left: 'Oban Elliott', Right: 'Preston Parsons', LeftLine: 2.25, RightLine: 1.66, FiveRound: false, Winner: 'Oban Elliott', Method: 'Decision', Round: 'D', Picks: { Alex: { Pick: 'Oban Elliott', Method: 'Decision', Round: 'D', Points: 15, CardTotal: 47, Total: 180, Profit: 1.25 }, Kieran: { Pick: 'Preston Parsons', Method: 'Decision', Round: 'D', Points: 0, CardTotal: 32, Total: 127, Profit: -1 }, Rob: { Pick: 'Oban Elliott', Method: 'Decision', Round: 'D', Points: 15, CardTotal: 32, Total: 169, Profit: 1.25 }, Jake: { Pick: 'Oban Elliott', Method: 'Decision', Round: 'D', Points: 15, CardTotal: 47, Total: 168, Profit: 1.25 }, } },
            { Card: 'UFC 304: Edwards vs Muhammad', Date: '2024-07-27', Left: 'Muhammad Mokaev', Right: 'Manel Kape', LeftLine: 1.8, RightLine: 2, FiveRound: false, Winner: 'Muhammad Mokaev', Method: 'Decision', Round: 'D', Picks: { Alex: { Pick: 'Muhammad Mokaev', Method: 'Submission', Round: '1', Points: 5, CardTotal: 52, Total: 185, Profit: 0.8 }, Kieran: { Pick: 'Muhammad Mokaev', Method: 'Submission', Round: '3', Points: 5, CardTotal: 37, Total: 132, Profit: 0.8 }, Rob: { Pick: 'Muhammad Mokaev', Method: 'Decision', Round: 'D', Points: 15, CardTotal: 47, Total: 184, Profit: 0.8 }, Jake: { Pick: 'Muhammad Mokaev', Method: 'Submission', Round: '3', Points: 5, CardTotal: 52, Total: 173, Profit: 0.8 }, } },
            { Card: 'UFC 304: Edwards vs Muhammad', Date: '2024-07-27', Left: 'Caolan Loughran', Right: 'Jake Hadley', LeftLine: 1.53, RightLine: 2.62, FiveRound: false, Winner: 'Jake Hadley', Method: 'Decision', Round: 'D', Picks: { Alex: { Pick: 'Caolan Loughran', Method: 'Decision', Round: 'D', Points: 0, CardTotal: 52, Total: 185, Profit: -1 }, Kieran: { Pick: 'Caolan Loughran', Method: 'Decision', Round: 'D', Points: 0, CardTotal: 37, Total: 132, Profit: -1 }, Rob: { Pick: 'Caolan Loughran', Method: 'Decision', Round: 'D', Points: 0, CardTotal: 47, Total: 184, Profit: -1 }, Jake: { Pick: 'Jake Hadley', Method: 'Decision', Round: 'D', Points: 15, CardTotal: 67, Total: 188, Profit: 1.62 }, } },
            { Card: 'UFC 304: Edwards vs Muhammad', Date: '2024-07-27', Left: 'Molly McCann', Right: 'Bruna Brasil', LeftLine: 1.4, RightLine: 3, FiveRound: false, Winner: 'Bruna Brasil', Method: 'Decision', Round: 'D', Picks: { Alex: { Pick: 'Molly McCann', Method: 'Knockout', Round: '2', Points: 0, CardTotal: 52, Total: 185, Profit: -1 }, Kieran: { Pick: 'Molly McCann', Method: 'Knockout', Round: '2', Points: 0, CardTotal: 37, Total: 132, Profit: -1 }, Rob: { Pick: 'Molly McCann', Method: 'Decision', Round: 'D', Points: 0, CardTotal: 47, Total: 184, Profit: -1 }, Jake: { Pick: 'Molly McCann', Method: 'Submission', Round: '1', Points: 0, CardTotal: 67, Total: 188, Profit: -1 }, } },
            { Card: 'UFC 304: Edwards vs Muhammad', Date: '2024-07-27', Left: 'Nathaniel Wood', Right: 'Daniel Pineda', LeftLine: 1.25, RightLine: 4, FiveRound: false, Winner: 'Nathaniel Wood', Method: 'Decision', Round: 'D', Picks: { Alex: { Pick: 'Nathaniel Wood', Method: 'Decision', Round: 'D', Points: 15, CardTotal: 67, Total: 200, Profit: 0.25 }, Kieran: { Pick: 'Nathaniel Wood', Method: 'Decision', Round: 'D', Points: 15, CardTotal: 52, Total: 147, Profit: 0.25 }, Rob: { Pick: 'Nathaniel Wood', Method: 'Decision', Round: 'D', Points: 15, CardTotal: 62, Total: 199, Profit: 0.25 }, Jake: { Pick: 'Nathaniel Wood', Method: 'Decision', Round: 'D', Points: 15, CardTotal: 82, Total: 203, Profit: 0.25 }, } },
            { Card: 'UFC 304: Edwards vs Muhammad', Date: '2024-07-27', Left: 'Arnold Allen', Right: 'Giga Chikadze', LeftLine: 1.4, RightLine: 3, FiveRound: false, Winner: 'Arnold Allen', Method: 'Decision', Round: 'D', Picks: { Alex: { Pick: 'Arnold Allen', Method: 'Decision', Round: 'D', Points: 15, CardTotal: 82, Total: 215, Profit: 0.4 }, Kieran: { Pick: 'Arnold Allen', Method: 'Decision', Round: 'D', Points: 15, CardTotal: 67, Total: 162, Profit: 0.4 }, Rob: { Pick: 'Arnold Allen', Method: 'Knockout', Round: '2', Points: 5, CardTotal: 67, Total: 204, Profit: 0.4 }, Jake: { Pick: 'Arnold Allen', Method: 'Knockout', Round: '1', Points: 5, CardTotal: 87, Total: 208, Profit: 0.4 }, } },
            { Card: 'UFC 304: Edwards vs Muhammad', Date: '2024-07-27', Left: 'Christian Duncan', Right: 'Gregory Rodrigues', LeftLine: 1.8, RightLine: 2, FiveRound: false, Winner: 'Gregory Rodrigues', Method: 'Decision', Round: 'D', Picks: { Alex: { Pick: 'Christian Duncan', Method: 'Knockout', Round: '2', Points: 0, CardTotal: 82, Total: 215, Profit: -1 }, Kieran: { Pick: 'Gregory Rodrigues', Method: 'Knockout', Round: '2', Points: 5, CardTotal: 72, Total: 167, Profit: 1 }, Rob: { Pick: 'Christian Duncan', Method: 'Knockout', Round: '3', Points: 0, CardTotal: 67, Total: 204, Profit: -1 }, Jake: { Pick: 'Christian Duncan', Method: 'Knockout', Round: '2', Points: 0, CardTotal: 87, Total: 208, Profit: -1 }, } },
            { Card: 'UFC 304: Edwards vs Muhammad', Date: '2024-07-27', Left: 'Bobby Green', Right: 'Paddy Pimblett', LeftLine: 1.72, RightLine: 2.1, FiveRound: false, Winner: 'Paddy Pimblett', Method: 'Submission', Round: '1', Picks: { Alex: { Pick: 'Paddy Pimblett', Method: 'Decision', Round: 'D', Points: 5, CardTotal: 87, Total: 220, Profit: 1.1 }, Kieran: { Pick: 'Paddy Pimblett', Method: 'Submission', Round: '2', Points: 7, CardTotal: 79, Total: 174, Profit: 1.1 }, Rob: { Pick: 'Paddy Pimblett', Method: 'Decision', Round: 'D', Points: 5, CardTotal: 72, Total: 209, Profit: 1.1 }, Jake: { Pick: 'Paddy Pimblett', Method: 'Decision', Round: 'D', Points: 5, CardTotal: 92, Total: 213, Profit: 1.1 }, } },
            { Card: 'UFC 304: Edwards vs Muhammad', Date: '2024-07-27', Left: 'Tom Aspinall', Right: 'Curtis Blaydes', LeftLine: 1.36, RightLine: 3.25, FiveRound: true, Winner: 'Tom Aspinall', Method: 'Knockout', Round: '1', Picks: { Alex: { Pick: 'Tom Aspinall', Method: 'Knockout', Round: '1', Points: 30, CardTotal: 117, Total: 250, Profit: 0.36 }, Kieran: { Pick: 'Tom Aspinall', Method: 'Knockout', Round: '2', Points: 14, CardTotal: 93, Total: 188, Profit: 0.36 }, Rob: { Pick: 'Tom Aspinall', Method: 'Knockout', Round: '2', Points: 14, CardTotal: 86, Total: 223, Profit: 0.36 }, Jake: { Pick: 'Tom Aspinall', Method: 'Knockout', Round: '1', Points: 30, CardTotal: 122, Total: 243, Profit: 0.36 }, } },
            { Card: 'UFC 304: Edwards vs Muhammad', Date: '2024-07-27', Left: 'Leon Edwards', Right: 'Belal Muhammad', LeftLine: 1.5, RightLine: 2.7, FiveRound: true, Winner: 'Belal Muhammad', Method: 'Decision', Round: 'D', Picks: { Alex: { Pick: 'Leon Edwards', Method: 'Decision', Round: 'D', Points: 0, CardTotal: 117, Total: 250, Profit: -1 }, Kieran: { Pick: 'Leon Edwards', Method: 'Decision', Round: 'D', Points: 0, CardTotal: 93, Total: 188, Profit: -1 }, Rob: { Pick: 'Leon Edwards', Method: 'Decision', Round: 'D', Points: 0, CardTotal: 86, Total: 223, Profit: -1 }, Jake: { Pick: 'Leon Edwards', Method: 'Decision', Round: 'D', Points: 0, CardTotal: 122, Total: 243, Profit: -1 }, } },
            { Card: 'UFC Fight Night: Adesanya vs Imavov', Date: '2025-02-01', Left: 'Hamdy Abdelwahab', Right: 'Jamal Pogues', LeftLine: 1.9, RightLine: 1.9, FiveRound: false, Winner: 'Hamdy Abdelwahab', Method: 'Decision', Round: 'D', Picks: { Alex: { Pick: 'Hamdy Abdelwahab', Method: 'Knockout', Round: '1', Points: 5, CardTotal: 5, Total: 255, Profit: 0.9 }, Kieran: { Pick: 'Jamal Pogues', Method: 'Decision', Round: 'D', Points: 0, CardTotal: 0, Total: 188, Profit: -1 }, Rob: { Pick: 'Hamdy Abdelwahab', Method: 'Knockout', Round: '3', Points: 5, CardTotal: 5, Total: 228, Profit: 0.9 }, Jake: { Pick: 'Hamdy Abdelwahab', Method: 'Knockout', Round: '1', Points: 5, CardTotal: 5, Total: 248, Profit: 0.9 }, } },
            { Card: 'UFC Fight Night: Adesanya vs Imavov', Date: '2025-02-01', Left: 'Bogdan Grad', Right: 'Lucas Alexander', LeftLine: 2, RightLine: 1.8, FiveRound: false, Winner: 'Bogdan Grad', Method: 'Knockout', Round: '2', Picks: { Alex: { Pick: 'Bogdan Grad', Method: 'Decision', Round: 'D', Points: 5, CardTotal: 10, Total: 260, Profit: 1 }, Kieran: { Pick: 'Bogdan Grad', Method: 'Knockout', Round: '1', Points: 7, CardTotal: 7, Total: 195, Profit: 1 }, Rob: { Pick: 'Bogdan Grad', Method: 'Decision', Round: 'D', Points: 5, CardTotal: 10, Total: 233, Profit: 1 }, Jake: { Pick: 'Bogdan Grad', Method: 'Knockout', Round: '2', Points: 15, CardTotal: 20, Total: 263, Profit: 1 }, } },
            { Card: 'UFC Fight Night: Adesanya vs Imavov', Date: '2025-02-01', Left: 'Jasmine Jasudavicius', Right: 'Mayra Bueno Silva', LeftLine: 1.4, RightLine: 3, FiveRound: false, Winner: 'Jasmine Jasudavicius', Method: 'Decision', Round: 'D', Picks: { Alex: { Pick: 'Jasmine Jasudavicius', Method: 'Decision', Round: 'D', Points: 15, CardTotal: 25, Total: 275, Profit: 0.4 }, Kieran: { Pick: 'Jasmine Jasudavicius', Method: 'Submission', Round: '3', Points: 5, CardTotal: 12, Total: 200, Profit: 0.4 }, Rob: { Pick: 'Mayra Bueno Silva', Method: 'Decision', Round: 'D', Points: 0, CardTotal: 10, Total: 233, Profit: -1 }, Jake: { Pick: 'Jasmine Jasudavicius', Method: 'Submission', Round: '3', Points: 5, CardTotal: 25, Total: 268, Profit: 0.4 }, } },
            { Card: 'UFC Fight Night: Adesanya vs Imavov', Date: '2025-02-01', Left: 'Terrance McKinney', Right: 'Damir Hadzovic', LeftLine: 1.22, RightLine: 4.5, FiveRound: false, Winner: 'Terrance McKinney', Method: 'Knockout', Round: '1', Picks: { Alex: { Pick: 'Terrance McKinney', Method: 'Knockout', Round: '1', Points: 15, CardTotal: 40, Total: 290, Profit: 0.22 }, Kieran: { Pick: 'Terrance McKinney', Method: 'Knockout', Round: '2', Points: 7, CardTotal: 19, Total: 207, Profit: 0.22 }, Rob: { Pick: 'Terrance McKinney', Method: 'Knockout', Round: '1', Points: 15, CardTotal: 25, Total: 248, Profit: 0.22 }, Jake: { Pick: 'Terrance McKinney', Method: 'Decision', Round: 'D', Points: 5, CardTotal: 30, Total: 273, Profit: 0.22 }, } },
            { Card: 'UFC Fight Night: Adesanya vs Imavov', Date: '2025-02-01', Left: 'Shamil Gaziev', Right: 'Thomas Petersen', LeftLine: 1.28, RightLine: 3.75, FiveRound: false, Winner: 'Shamil Gaziev', Method: 'Knockout', Round: '1', Picks: { Alex: { Pick: 'Shamil Gaziev', Method: 'Decision', Round: 'D', Points: 5, CardTotal: 45, Total: 295, Profit: 0.28 }, Kieran: { Pick: 'Shamil Gaziev', Method: 'Knockout', Round: '2', Points: 7, CardTotal: 26, Total: 214, Profit: 0.28 }, Rob: { Pick: 'Shamil Gaziev', Method: 'Decision', Round: 'D', Points: 5, CardTotal: 30, Total: 253, Profit: 0.28 }, Jake: { Pick: 'Shamil Gaziev', Method: 'Decision', Round: 'D', Points: 5, CardTotal: 35, Total: 278, Profit: 0.28 }, } },
            { Card: 'UFC Fight Night: Adesanya vs Imavov', Date: '2025-02-01', Left: 'Muhammad Naimov', Right: 'Kaan Ofli', LeftLine: 1.33, RightLine: 3.4, FiveRound: false, Winner: 'Muhammad Naimov', Method: 'Decision', Round: 'D', Picks: { Alex: { Pick: 'Muhammad Naimov', Method: 'Knockout', Round: '2', Points: 5, CardTotal: 50, Total: 300, Profit: 0.33 }, Kieran: { Pick: 'Kaan Ofli', Method: 'Submission', Round: '2', Points: 0, CardTotal: 26, Total: 214, Profit: -1 }, Rob: { Pick: 'Muhammad Naimov', Method: 'Decision', Round: 'D', Points: 15, CardTotal: 45, Total: 268, Profit: 0.33 }, Jake: { Pick: 'Muhammad Naimov', Method: 'Knockout', Round: '1', Points: 5, CardTotal: 40, Total: 283, Profit: 0.33 }, } },
            { Card: 'UFC Fight Night: Adesanya vs Imavov', Date: '2025-02-01', Left: 'Farès Ziam', Right: 'Mike Davis', LeftLine: 2.25, RightLine: 1.66, FiveRound: false, Winner: 'Farès Ziam', Method: 'Decision', Round: 'D', Picks: { Alex: { Pick: 'Farès Ziam', Method: 'Decision', Round: 'D', Points: 15, CardTotal: 65, Total: 315, Profit: 1.25 }, Kieran: { Pick: 'Mike Davis', Method: 'Submission', Round: '2', Points: 0, CardTotal: 26, Total: 214, Profit: -1 }, Rob: { Pick: 'Mike Davis', Method: 'Knockout', Round: '3', Points: 0, CardTotal: 45, Total: 268, Profit: -1 }, Jake: { Pick: 'Mike Davis', Method: 'Decision', Round: 'D', Points: 0, CardTotal: 40, Total: 283, Profit: -1 }, } },
            { Card: 'UFC Fight Night: Adesanya vs Imavov', Date: '2025-02-01', Left: 'Said Nurmagomedov', Right: 'Vinicius Oliveira', LeftLine: 1.62, RightLine: 2.3, FiveRound: false, Winner: 'Vinicius Oliveira', Method: 'Decision', Round: 'D', Picks: { Alex: { Pick: 'Said Nurmagomedov', Method: 'Decision', Round: 'D', Points: 0, CardTotal: 65, Total: 315, Profit: -1 }, Kieran: { Pick: 'Said Nurmagomedov', Method: 'Submission', Round: '2', Points: 0, CardTotal: 26, Total: 214, Profit: -1 }, Rob: { Pick: 'Vinicius Oliveira', Method: 'Decision', Round: 'D', Points: 15, CardTotal: 60, Total: 283, Profit: 1.3 }, Jake: { Pick: 'Said Nurmagomedov', Method: 'Submission', Round: '1', Points: 0, CardTotal: 40, Total: 283, Profit: -1 }, } },
            { Card: 'UFC Fight Night: Adesanya vs Imavov', Date: '2025-02-01', Left: 'Sergei Pavlovic', Right: 'Jairzinho Rozenstruik', LeftLine: 1.3, RightLine: 3.5, FiveRound: false, Winner: 'Sergei Pavlovic', Method: 'Decision', Round: 'D', Picks: { Alex: { Pick: 'Sergei Pavlovic', Method: 'Knockout', Round: '1', Points: 5, CardTotal: 70, Total: 320, Profit: 0.3 }, Kieran: { Pick: 'Sergei Pavlovic', Method: 'Knockout', Round: '1', Points: 5, CardTotal: 31, Total: 219, Profit: 0.3 }, Rob: { Pick: 'Sergei Pavlovic', Method: 'Knockout', Round: '1', Points: 5, CardTotal: 65, Total: 288, Profit: 0.3 }, Jake: { Pick: 'Sergei Pavlovic', Method: 'Decision', Round: 'D', Points: 15, CardTotal: 55, Total: 298, Profit: 0.3 }, } },
            { Card: 'UFC Fight Night: Adesanya vs Imavov', Date: '2025-02-01', Left: 'Shara Magomedov', Right: 'Michael Page', LeftLine: 1.53, RightLine: 2.62, FiveRound: false, Winner: 'Michael Page', Method: 'Decision', Round: 'D', Picks: { Alex: { Pick: 'Michael Page', Method: 'Decision', Round: 'D', Points: 15, CardTotal: 85, Total: 335, Profit: 1.62 }, Kieran: { Pick: 'Shara Magomedov', Method: 'Knockout', Round: '3', Points: 0, CardTotal: 31, Total: 219, Profit: -1 }, Rob: { Pick: 'Shara Magomedov', Method: 'Decision', Round: 'D', Points: 0, CardTotal: 65, Total: 288, Profit: -1 }, Jake: { Pick: 'Shara Magomedov', Method: 'Decision', Round: 'D', Points: 0, CardTotal: 55, Total: 298, Profit: -1 }, } },
            { Card: 'UFC Fight Night: Adesanya vs Imavov', Date: '2025-02-01', Left: 'Israel Adesanya', Right: 'Nassourdine Imavov', LeftLine: 1.61, RightLine: 2.37, FiveRound: true, Winner: 'Nassourdine Imavov', Method: 'Knockout', Round: '2', Picks: { Alex: { Pick: 'Israel Adesanya', Method: 'Decision', Round: 'D', Points: 0, CardTotal: 85, Total: 335, Profit: -1 }, Kieran: { Pick: 'Israel Adesanya', Method: 'Decision', Round: 'D', Points: 0, CardTotal: 31, Total: 219, Profit: -1 }, Rob: { Pick: 'Israel Adesanya', Method: 'Knockout', Round: '2', Points: 0, CardTotal: 65, Total: 288, Profit: -1 }, Jake: { Pick: 'Nassourdine Imavov', Method: 'Decision', Round: 'D', Points: 10, CardTotal: 65, Total: 308, Profit: 1.37 }, } },
        ];
        var cardData = Object.groupBy(fightData, ({ Card }) => Card);
    </script>
    <script>
        let gbpFormat = new Intl.NumberFormat('en-GB', {
            style: 'currency',
            currency: 'GBP',
        });

        function formatPercentage(num) { return Number(num).toLocaleString(undefined, { style: 'percent', minimumFractionDigits: 2 }); }

        function generateLeagueTable() {
            // Generate a record for each player.
            var playerInfo = {};
            for (var px in players) {
                var player = players[px];
                playerInfo[player] = {
                    Correct: 0,
                    Methods: 0,
                    Rounds: 0,
                    Trebles: 0,
                    Points: 0,
                    Profit: 0,
                    Titles: 0
                };
            }

            // Generate a record for each card.
            var cardInfo = {};
            for (var cardName in cardData) {
                var cardDate = cardData[cardName][0].Date;
                cardInfo[cardName] = {
                    Date: cardDate,
                    MaxPts: 0,
                    Alex: 0,
                    Kieran: 0,
                    Rob: 0,
                    Jake: 0,
                    Champion: "",
                    Accuracy: 0
                };
            }

            // Calculate scores for each player.
            for (var cardName in cardData) {
                var card = cardData[cardName];
                var cardScores = {};
                for (var fx in card) {
                    var fight = card[fx];

                    var maxPts = fight.FiveRound ? 30 : 15;
                    cardInfo[cardName].MaxPts += maxPts;

                    for (var px in players) {
                        var player = players[px];
                        var pick = fight.Picks[player];
                        var isCorrect = pick.Pick == fight.Winner;
                        var isMethod = isCorrect && pick.Method == fight.Method;
                        var isRound = isCorrect && pick.Round == fight.Round;
                        var isTreble = isCorrect && isMethod && isRound;
                        if (isCorrect) playerInfo[player].Correct++;
                        if (isMethod) playerInfo[player].Methods++;
                        if (isRound) playerInfo[player].Rounds++;
                        if (isTreble) playerInfo[player].Trebles++;
                        playerInfo[player].Points = pick.Total;
                        playerInfo[player].Profit += pick.Profit;
                        cardScores[player] = pick.CardTotal;

                        cardInfo[cardName][player] = pick.CardTotal;
                    }
                }
                var cardWinner = null;
                var winnerScore = 0;
                for (var px in players) {
                    var player = players[px];
                    var score = cardScores[player];
                    if (score > winnerScore) {
                        winnerScore = score;
                        cardWinner = player;
                    }
                }
                playerInfo[cardWinner].Titles++;
                cardInfo[cardName].Winner = cardWinner;
                cardInfo[cardName].Accuracy = winnerScore / cardInfo[cardName].MaxPts;
            }

            // Generate individual row data for the league table.
            var leagueRows = [];
            for (var px in players) {
                var player = players[px];
                var result = playerInfo[player];
                var playerRow = [player, result.Correct, result.Methods, result.Rounds, result.Trebles, result.Points, result.Titles, gbpFormat.format(result.Profit)];
                leagueRows.push(playerRow);
            }

            // Create the league datatable.
            var leagueTable = new DataTable("#league-table", {
                columns: [
                    { title: "Player" },
                    { title: "Correct" },
                    { title: "Method" },
                    { title: "Round" },
                    { title: "Treble" },
                    { title: "Points" },
                    { title: "Titles" },
                    { title: "Profit", type: "num-fmt" }
                ],
                order: [[5, "desc"]],
                paging: false,
                searching: false,
                info: false,
                responsive: true,
                data: leagueRows
            });

            var titleRows = [];
            for (var cardName in cardInfo) {
                var card = cardInfo[cardName];
                var cardRow = [card.Date, cardName, card.MaxPts, card.Alex, card.Kieran, card.Rob, card.Jake, card.Winner, formatPercentage(card.Accuracy)];
                titleRows.push(cardRow);
            }

            // Create the title history datatable.
            var titleTable = new DataTable("#title-history", {
                columns: [
                    { title: "Date", type: "date" },
                    { title: "Event" },
                    { title: "Total" },
                    { title: "Alex" },
                    { title: "Kieran" },
                    { title: "Rob" },
                    { title: "Jake" },
                    { title: "Champ." },
                    { title: "% Pts" }
                ],
                paging: false,
                searching: false,
                info: false,
                responsive: true,
                data: titleRows
            });
        }

        function populateEventResults() {
            var selectInput = $("#event-result-select");

            for (var cardName in cardData) {
                var cardDate = cardData[cardName][0].Date;
                var cardOption = $(`<option value='${cardName}'>[${cardDate}] ${cardName}</option>`);
                selectInput.prepend(cardOption);
                selectInput.val(cardName);
            }

            selectInput.change(function () {
                generateEventTable();
            });
        }

        var eventResultTable = new DataTable("#event-results", {
            paging: false,
            searching: false,
            info: false,
            responsive: true,
            order: [[0, "asc"]],
            columnDefs: [
                { className: 'table-info', targets: [5, 6, 7, 8, 9, 10] },
                { className: 'table-success', targets: [11, 12, 13, 14, 15, 16] },
                { className: 'table-warning', targets: [17, 18, 19, 20, 21, 22] },
                { className: 'table-danger', targets: [23, 24, 25, 26, 27, 28] }
            ]
        });

        var eventResultChart = new Chart(document.getElementById("event-result-canvas"), {
                type: 'line',
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        x: {
                            ticks: {
                                maxRotation: 90,
                                minRotation: 90
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            position: 'bottom'
                        }
                    }
                }
            });

        function generateEventTable() {
            var selectedCardName = $("#event-result-select").val();
            var cardFights = cardData[selectedCardName];

            eventResultTable.clear();
            var chartData = {
                labels: [],
                datasets: [
                    { label: 'Alex', data: [], borderColor: CHART_COLORS.blue, backgroundColor: CHART_COLORS.blue },
                    { label: 'Kieran', data: [], borderColor: CHART_COLORS.green, backgroundColor: CHART_COLORS.green },
                    { label: 'Rob', data: [], borderColor: CHART_COLORS.yellow, backgroundColor: CHART_COLORS.yellow },
                    { label: 'Jake', data: [], borderColor: CHART_COLORS.red, backgroundColor: CHART_COLORS.red },
                ]
            }

            var fightRows = [];
            for (var ix in cardFights) {
                var fight = cardFights[ix];
                var fightName = `${fight.Left.split(" ")[1]} vs ${fight.Right.split(" ")[1]}`;
                var fightRow = [parseInt(ix) + 1, fightName, fight.Winner.split(" ")[1], shortMethod(fight.Method), fight.Round,
                fight.Picks.Alex.Pick.split(" ")[1], shortMethod(fight.Picks.Alex.Method), fight.Picks.Alex.Round, fight.Picks.Alex.Points, gbpFormat.format(fight.Picks.Alex.Profit), fight.Picks.Alex.CardTotal,
                fight.Picks.Kieran.Pick.split(" ")[1], shortMethod(fight.Picks.Kieran.Method), fight.Picks.Kieran.Round, fight.Picks.Kieran.Points, gbpFormat.format(fight.Picks.Kieran.Profit), fight.Picks.Kieran.CardTotal,
                fight.Picks.Rob.Pick.split(" ")[1], shortMethod(fight.Picks.Rob.Method), fight.Picks.Rob.Round, fight.Picks.Rob.Points, gbpFormat.format(fight.Picks.Rob.Profit), fight.Picks.Rob.CardTotal,
                fight.Picks.Jake.Pick.split(" ")[1], shortMethod(fight.Picks.Jake.Method), fight.Picks.Jake.Round, fight.Picks.Jake.Points, gbpFormat.format(fight.Picks.Jake.Profit), fight.Picks.Jake.CardTotal,
                ];
                fightRows.push(fightRow);
                chartData.labels.push(fightName);
                chartData.datasets[0].data.push(fight.Picks.Alex.CardTotal);
                chartData.datasets[1].data.push(fight.Picks.Kieran.CardTotal);
                chartData.datasets[2].data.push(fight.Picks.Rob.CardTotal);
                chartData.datasets[3].data.push(fight.Picks.Jake.CardTotal);
            }
            eventResultTable.rows.add(fightRows);
            eventResultTable.draw();
            eventResultChart.data = chartData;
            eventResultChart.update();
        }

        function shortMethod(method) {
            switch (method) {
                case "Knockout":
                    return "KO";
                case "Submission":
                    return "Sub";
                case "Decision":
                    return "Dec";
            }
        }

        $(document).ready(function () {
            generateLeagueTable();
            populateEventResults();
            generateEventTable();
        });
    </script>
</body>
